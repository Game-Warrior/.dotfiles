var e,t,s;function a(e,t){return new Promise((s=>{chrome.cookies.get({url:"https://twitter.com",name:"ct0"},(async a=>{if(!a)return s("retry");200!==(await fetch("https://twitter.com/i/api/1.1"+e,{method:"POST",headers:{Authorization:"Bearer AAAAAAAAAAAAAAAAAAAAANRILgAAAAAAnNwIzUejRCOuH5E6I8xnZz4puTs%3D1Zv7ttfk8LF81IUq16cHjhLTvJu4FA33AGWWjCpTnA","Content-Type":"application/x-www-form-urlencoded","x-twitter-active-user":"yes","x-csrf-token":a.value,"x-twitter-auth-type":"OAuth2Session","x-twitter-client-language":"en"},credentials:"include",mode:"cors",body:t})).status&&s("delay"),s("success");}));}))}chrome.runtime.onInstalled.addListener((()=>{chrome.alarms.create({periodInMinutes:1});})),chrome.alarms.onAlarm.addListener((e=20,t=2,s=60,()=>{const o=Date.now();console.log("alarm called",o);const n=async()=>{const[i,r]=await new Promise((e=>{chrome.storage.sync.get(["actionQueue","whitelistedUsers"],(t=>{const{actionQueue:s,whitelistedUsers:a}=t;e([null!=s?s:[],null!=a?a:[]]);}));})),c=function(e,t){var s;const a=new Set(t.map((e=>e.id)));for(let t=0;t<e.length;t++)if(void 0===e[t].doneAt&&!a.has(e[t].id)){const a=null===(s=e[t-1])||void 0===s?void 0:s.doneAt;return a?Date.now()-a>1e4?e[t]:void 0:e[t]}}(i,r);if(c){await async function(e,t){let s;switch(console.log("Performing action:",e),e.action){case"block":s=await a("/blocks/create.json","user_id="+e.id);break;case"follow":s=await a("/friendships/create.json","user_id="+e.id);break;case"mute":s=await a("/mutes/users/create.json","user_id="+e.id);break;default:s="success";}switch(console.log("Result:",s),s){case"success":case"fail":e.doneAt=Date.now(),await new Promise((e=>{chrome.storage.sync.set({actionQueue:t},(()=>e()));}));break;case"retry":break;case"delay":t.push(t.splice(t.indexOf(e),1)[0]),await new Promise((e=>{chrome.storage.sync.set({actionQueue:t},(()=>e()));}));}}(c,i);const r=1e3*(e+(Math.random()-.5)*t);Date.now()+r-o<1e3*s&&setTimeout(n,r);}};n();}));
